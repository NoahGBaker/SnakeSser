[gd_scene load_steps=3 format=3 uid="uid://dx4m8k2eetvl4"]

[ext_resource type="PackedScene" uid="uid://ccmu71e6vyuad" path="res://SnakeSser/snake_segment.tscn" id="2_12yiw"]

[sub_resource type="GDScript" id="GDScript_y0lfc"]
script/source = "extends CharacterBody2D
class_name snake_head

const SPEED = 300.0

var direction_pos
var direction
var curr_pos
var target_pos
var next_pos

const Row = 50
const Collumn = 50

var GRID :Array

@onready var snake_segment_resource = preload(\"res://SnakeSser/snake_segment.tscn\")

func _ready():
	
	var new_segment = snake_segment_resource.instantiate()
	add_child(new_segment)
	
	direction = Vector2.RIGHT
	
	for i in range(Collumn):
		GRID.append([])
		for j in range(Row):
			GRID[i].append(Vector2(i * 10 + 100, j * 10 + 100))
	position = GRID[3][5]
	target_pos = GRID[4][5]
	curr_pos = GRID[3][5]
	#print(GRID)


func _unhandled_input(event):
	if event.is_action_pressed(\"ui_left\"):
		direction = Vector2.LEFT
	if event.is_action_pressed(\"ui_right\"):
		direction = Vector2.RIGHT
	if event.is_action_pressed(\"ui_up\"):
		direction = Vector2.UP
	if event.is_action_pressed(\"ui_down\"):
		direction = Vector2.DOWN
	position = curr_pos
	direction_pos = next_pos
#Use direction_pos to get the position of where we turn and get the turn direction. Then use that to have a snake segment turn there

#Get place for snake to go along a certain sort of grid then set that goal to the previous snake body segment
func _physics_process(delta):
	# move towards target position
	position = position.move_toward(target_pos, SPEED * delta)
	if position == target_pos:
		# if we have reached the target
		next_pos = target_pos + direction * 10
		target_pos = next_pos
		curr_pos = _get_position_from_grid(target_pos.x/10,target_pos.y/10) - direction * 10
		print(direction_pos)
		print(direction)
		print(curr_pos)


func _get_position_from_grid(col : int, row : int) -> Vector2:
	return Vector2(col * 10, row * 10)

func move_segment(segment : Area2D):
	
	pass
"

[node name="Player" type="Area2D"]
script = SubResource("GDScript_y0lfc")

[node name="CharacterBody2D" parent="." instance=ExtResource("2_12yiw")]
