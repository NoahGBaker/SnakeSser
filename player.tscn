[gd_scene load_steps=4 format=3 uid="uid://dx4m8k2eetvl4"]

[ext_resource type="Texture2D" uid="uid://cle4mv627dc4b" path="res://SnakeSser/icon.svg" id="1_4rojq"]

[sub_resource type="GDScript" id="GDScript_y0lfc"]
script/source = "extends CharacterBody2D

const SPEED = 300.0
var curr_pos
var target_pos
var next_pos

const Row = 51
const Collumn = 51

var direction_pos
var next_direction

var GRID :Array

func _ready():
	next_direction = Vector2.RIGHT
	
	for i in range(Collumn):
		GRID.append([])
		for j in range(Row):
			GRID[i].append(Vector2(i * 10 + 100, j * 10 + 100))
	position = GRID[3][24]
	target_pos = GRID[4][24]
	curr_pos = GRID[3][24]
	#print(GRID)


func _unhandled_input(event):
	if event.is_action_pressed(\"ui_left\"):
		next_direction = Vector2.LEFT
		direction_pos = next_pos
	if event.is_action_pressed(\"ui_right\"):
		next_direction = Vector2.RIGHT
		direction_pos = next_pos
	if event.is_action_pressed(\"ui_up\"):
		next_direction = Vector2.UP
		direction_pos = next_pos
	if event.is_action_pressed(\"ui_down\"):
		next_direction = Vector2.DOWN
		direction_pos = next_pos

#we need a target position which will be set to next pos when we get there
#Also we need always set a next position even while we are moving.
#Also dont use lerp use move_toward()

#Get place for snake to go along a certain sort of grid then set that goal to the previous snake body segment
func _physics_process(delta):
	# move towards target position
	position = position.move_toward(target_pos, SPEED * delta)
	if position == target_pos:
		# if we have reached the target
		next_pos = target_pos + next_direction * 10
		target_pos = next_pos
		curr_pos = _get_position_from_grid(target_pos.x/10,target_pos.y/10) - next_direction * 10
		print(target_pos)
		print(curr_pos)


func _get_position_from_grid(col : int, row : int) -> Vector2:
	return Vector2(col * 10, row * 10)
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ilb8m"]
size = Vector2(95, 89)

[node name="Player" type="CharacterBody2D"]
script = SubResource("GDScript_y0lfc")

[node name="Icon" type="Sprite2D" parent="."]
position = Vector2(37, 32)
scale = Vector2(0.765625, 0.765625)
texture = ExtResource("1_4rojq")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(37.5, 34.5)
shape = SubResource("RectangleShape2D_ilb8m")
